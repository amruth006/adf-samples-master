/* Copyright 2010, 2017, Oracle and/or its affiliates. All rights reserved. */
package test.mypackage;
import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;

import oracle.jbo.domain.Number;
import oracle.jbo.server.ViewRowSetImpl;
//  ---------------------------------------------------------------------
//  ---    File generated by Oracle ADF Business Components Design Time.
//  ---    Custom code may be added to this class.
//  ---    Warning: Do not modify method signatures of generated methods.
//  ---------------------------------------------------------------------

public class EmpViewImpl extends DeclarativeRecalculatingViewObjectImpl 
{
  private Number sumOfSal = null;
  /**
   * 
   *  This is the default constructor (do not remove)
   */
  public EmpViewImpl()
  {
  }
  public void recalculateSumOfSal() 
  {
    sumOfSal = null;
  }
  public Number getSumOfSal() 
  {
    if (sumOfSal == null) {
      sumOfSal = new Number(0);
      RowSetIterator rsi = createRowSetIterator(null);
      while (rsi.hasNext()) 
      {
        Row r = rsi.next();
        Number curSal = (Number)r.getAttribute("Sal");
        if (curSal != null) {
          sumOfSal = sumOfSal.add(curSal);
        }
      }
      rsi.closeRowSetIterator();
    }
    return sumOfSal;
  }


  protected void executeQueryForCollection(Object qc, Object[] params, int noUserParams)
  {
    // TODO:  Override this oracle.jbo.server.ViewObjectImpl method
    super.executeQueryForCollection(qc, params, noUserParams);
    recalculateSumOfSal();
  }

  protected void notifyRowDeleted(ViewRowSetImpl vrs, Row viewRow, int rowIndex)
  {
    // TODO:  Override this oracle.jbo.server.ViewObjectImpl method
    super.notifyRowDeleted(vrs, viewRow, rowIndex);
    recalculateSumOfSal();
    notifyRowUpdated(vrs,
                     vrs.getAllRowsInRange(),
                     new int[]{findAttributeDef("SumOfSal").getIndex()});
    
  }
}
